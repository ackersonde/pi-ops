checkNewVersion = true
logLevel = "INFO"
defaultEntryPoints = ["http", "https"]

[traefikLog]
  filePath = "/var/log/traefik/traefik.log"

[docker]
  endpoint = "unix:///var/run/docker.sock"
  domain = "ackerson.de"

[entryPoints]
  [entryPoints.http]
  address = ":80"
  compress = true
    [entryPoints.http.redirect]
    entryPoint = "https"

  [entryPoints.https]
  address = ":443"
  compress = true
    [entryPoints.https.redirect]
    regex = "^https://www.(.*)"
    replacement = "https://$1"
    [entryPoints.https.forwardedHeaders]
      trustedIPs = ["127.1.1.1/32"]
    [entryPoints.https.tls]

  # enable API backend & stats providing detailed metrics to dashboard
  [entrypoints.api]
  address=":8442"
  [api]
    entrypoint="api"
    [api.statistics]

# setup frontend route reverse proxied to API backend w/ basicAuth
[file]
  [backends]
    [backends.api]
      [backends.api.servers.api]
      url = "http://127.0.0.1:8442"

  [frontends]
    [frontends.monitor]
      basicAuth = ["admin:$apr1$Sy/ApXHY$fVtWyeyllJ5KvbENX1mgd/"]
      backend = "api"
        [frontends.monitor.routes.monitor]
          rule = "Host:monitor.ackerson.de"
        [frontends.monitor.ratelimit]
          extractorfunc = "client.ip"
          [frontends.monitor.ratelimit.rateset.rateset1]
            period = "10s"
            average = 100
            burst = 200

#[acme]
#email = "dan@ackerson.de"
#storage = "acme.json"
#entrypoint = "https"
#[acme.dnsChallenge]
#  provider = "digitalocean"
#[[acme.domains]]
#  main = "ackerson.de"
#  sans = ["www.ackerson.de", "monitor.ackerson.de"]
#[[acme.domains]]
#  main = "battlefleet.eu"
